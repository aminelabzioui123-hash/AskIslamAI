<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ø³Ø£Ù„ Ø§Ù„Ø¥Ø³Ù„Ø§Ù… AI</title>

<style>
body{
font-family: Arial;
background:#0a5f4f;
color:white;
display:flex;
justify-content:center;
align-items:center;
height:100vh;
margin:0;
}

.container{
width:700px;
height:90vh;
background:rgba(255,255,255,0.1);
border-radius:20px;
display:flex;
flex-direction:column;
overflow:hidden;
}

#chatArea{
flex:1;
overflow:auto;
padding:20px;
}

.message{
margin-bottom:15px;
}

.user{text-align:left;}
.assistant{text-align:right;}

.bubble{
display:inline-block;
padding:12px 18px;
border-radius:16px;
max-width:70%;
}

.user .bubble{background:#d4a57433;}
.assistant .bubble{background:#ffffff22;}

.quran{
font-size:22px;
color:gold;
font-weight:bold;
}

.input{
display:flex;
padding:15px;
gap:10px;
background:#ffffff11;
}

input{
flex:1;
padding:10px;
border-radius:10px;
border:none;
outline:none;
}

button{
background:gold;
border:none;
padding:10px 15px;
border-radius:10px;
cursor:pointer;
}
</style>
</head>

<body>

<div class="container">
<div id="chatArea"></div>

<div class="input">
<input id="userInput" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ">
<button onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„</button>
</div>
</div>

<script>

/* =================================
ğŸ“– Ù…ØµØ¯Ø± Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙˆØ­ÙŠØ¯ (Ø¥Ø¬Ø¨Ø§Ø±ÙŠ)
================================= */

const QURAN_BASE_URL =
"https://raw.githubusercontent.com/rn0x/Quran-Data/version-2.0/data/json/surah/";

/* =================================
Ø¬Ù„Ø¨ Ø³ÙˆØ±Ø© Ù…Ù† Ø§Ù„Ù…ØµØ¯Ø± ÙÙ‚Ø·
================================= */

async function fetchSurah(number){

try{

const res = await fetch(QURAN_BASE_URL + number + ".json",{
cache:"no-store"
});

if(!res.ok) return null;

return await res.json();

}catch{
return null;
}

}

/* =================================
Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø³ÙˆØ±Ø© + Ø±Ù‚Ù… Ø§Ù„Ø¢ÙŠØ©
================================= */

async function findAyahBySurahAndNumber(text){

text = text.replace("Ø³ÙˆØ±Ø©","").trim();

const parts = text.split(" ");

if(parts.length < 2) return null;

const surahName = parts[0];
const ayahNumber = parseInt(parts[1]);

for(let i=1;i<=114;i++){

const surah = await fetchSurah(i);

if(!surah) continue;

if(surah.name.includes(surahName)){

const ayah = surah.ayahs.find(a => a.number == ayahNumber);

if(ayah){
return {
surah: surah.name,
ayah: ayah.number,
text: ayah.text
};
}

}

}

return null;
}

/* =================================
Ø§Ù„Ø¨Ø­Ø« Ø¯Ø§Ø®Ù„ Ø§Ù„Ù‚Ø±Ø¢Ù†
================================= */

async function searchQuran(query){

for(let i=1;i<=114;i++){

const surah = await fetchSurah(i);

if(!surah) continue;

for(const ayah of surah.ayahs){

if(ayah.text.includes(query)){
return {
surah: surah.name,
ayah: ayah.number,
text: ayah.text
};
}

}

}

return null;
}

/* =================================
Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
================================= */

async function sendMessage(){

const input=document.getElementById("userInput");
const text=input.value.trim();

if(!text) return;

addMessage(text,"user");
input.value="";

/* Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬Ù„Ø¨ Ø¢ÙŠØ© Ù…Ø¨Ø§Ø´Ø±Ø© */
const directAyah = await findAyahBySurahAndNumber(text);

if(directAyah){

addMessage(
`<span class="quran">ï´¿ ${directAyah.text} ï´¾</span><br>
ğŸ“ Ø³ÙˆØ±Ø© ${directAyah.surah} - Ø¢ÙŠØ© ${directAyah.ayah}`,
"assistant"
);

return;
}

/* Ø¨Ø­Ø« Ø¹Ø§Ù… */
const res = await searchQuran(text);

if(res){

addMessage(
`<span class="quran">ï´¿ ${res.text} ï´¾</span><br>
ğŸ“ Ø³ÙˆØ±Ø© ${res.surah} - Ø¢ÙŠØ© ${res.ayah}`,
"assistant"
);

return;
}

/* Ø¥Ø°Ø§ Ù„Ù… ØªÙˆØ¬Ø¯ Ø£Ùˆ Ø§Ù„Ù…ØµØ¯Ø± ØºÙŠØ± Ù…ØªØ§Ø­ */
addMessage(
"âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¢ÙŠØ© ÙÙŠ Ø§Ù„Ù…ØµØ¯Ø± Ø§Ù„Ø±Ø³Ù…ÙŠ.",
"assistant"
);

}

/* =================================
Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
================================= */

function addMessage(text,type){

const chat=document.getElementById("chatArea");

const div=document.createElement("div");
div.className="message "+type;

div.innerHTML=`<div class="bubble">${text}</div>`;

chat.appendChild(div);
chat.scrollTop=chat.scrollHeight;

}

</script>

</body>
</html>
